<!doctype html>
<html>
  <head>
    <title>无图片的超快速捕获</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
      #source {
        border: 2px solid #4caf50;
        padding: 15px;
        margin: 10px 0;
        width: 300px;
      }
      #myCanvas {
        border: 2px dashed #f44336;
        margin-top: 10px;
      }
      button {
        padding: 8px 16px;
        background-color: #2196f3;
        color: white;
        border: none;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div id="source">
      <h3>待捕获内容</h3>
      <p>纯文本内容示例</p>
      <p>第二行文本信息</p>
      <!-- 基础SVG图形 -->
      <svg width="200" height="100" viewBox="0 0 200 100" xmlns="http://www.w3.org/2000/svg">
        <circle cx="50" cy="50" r="30" fill="#3498db" />
        <rect x="120" y="20" width="60" height="60" fill="#e74c3c" />
      </svg>
    </div>

    <button onclick="captureToCanvas()">极速捕获</button>
    <canvas id="myCanvas" width="600" height="400"></canvas>

    <script>
      function captureToCanvas() {
        const source = document.getElementById('source');
        const canvas = document.getElementById('myCanvas');
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // 固定缩放为1，最大化速度
        const captureScale = 1;

        // 精简配置，无图片无需处理跨域
        html2canvas(source, {
          logging: false,
          scale: captureScale,
          ignoreElements: (el) => el.tagName === 'STYLE',
          allowTaint: false,
        }).then((captured) => {
          // 直接绘制到画布
          ctx.drawImage(captured, 20, 20);
          ctx.fillStyle = 'black';
          ctx.font = '12px Arial';
          ctx.fillText('无图片模式（速度最优）', 20, 380);
        });
      }
    </script>
  </body>
</html>
